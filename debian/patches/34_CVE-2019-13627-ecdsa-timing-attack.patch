--- libgcrypt20-1.6.3.orig/mpi/ec.c
+++ libgcrypt20-1.6.3/mpi/ec.c
@@ -1114,6 +1114,11 @@ _gcry_mpi_ec_mul_point (mpi_point_t resu
       unsigned int nbits;
       int j;
 
+      if (mpi_cmp (scalar, ctx->p) >= 0)
+        nbits = mpi_get_nbits (scalar);
+      else
+        nbits = mpi_get_nbits (ctx->p);
+
       nbits = mpi_get_nbits (scalar);
       if (ctx->model == MPI_EC_WEIERSTRASS)
         {
